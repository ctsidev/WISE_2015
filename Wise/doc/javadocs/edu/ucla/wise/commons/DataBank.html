<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Wed May 07 11:32:18 PDT 2014 -->
<title>DataBank</title>
<meta name="date" content="2014-05-07">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="DataBank";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DataBank.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/ucla/wise/commons/ConsentForm.html" title="class in edu.ucla.wise.commons"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../edu/ucla/wise/commons/Directive.html" title="class in edu.ucla.wise.commons"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/ucla/wise/commons/DataBank.html" target="_top">Frames</a></li>
<li><a href="DataBank.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.ucla.wise.commons</div>
<h2 title="Class DataBank" class="title">Class DataBank</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>edu.ucla.wise.commons.DataBank</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">DataBank</span>
extends java.lang.Object</pre>
<div class="block">This class encapsulates the database interface for a Study Space. The static
 part represents the MySQL interface in general
 
 Also provides group-level update of the valid survey_user_states: invited,
 declined, start_reminder_x, non_responder, started, interrupted,
 completion_reminder_x, incompleter TODO: (low) abstract valid User-state
 progression into static final strings, either in Data_Bank or User class</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#dbdata">dbdata</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#dbDriver">dbDriver</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#dbpwd">dbpwd</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#dbuser">dbuser</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#decimalFieldDDL">decimalFieldDDL</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static char</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#decimalValueTypeFlag">decimalValueTypeFlag</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#emailEncryptionKey">emailEncryptionKey</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#intFieldDDL">intFieldDDL</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static char</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#intValueTypeFlag">intValueTypeFlag</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#MainTableExtension">MainTableExtension</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#mysqlServer">mysqlServer</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#textFieldDDL">textFieldDDL</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static char</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#textValueTypeFlag">textValueTypeFlag</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#DataBank(edu.ucla.wise.commons.StudySpace, edu.ucla.wise.studyspace.parameters.StudySpaceParameters)">DataBank</a></strong>(<a href="../../../../edu/ucla/wise/commons/StudySpace.html" title="class in edu.ucla.wise.commons">StudySpace</a>&nbsp;ss,
        edu.ucla.wise.studyspace.parameters.StudySpaceParameters&nbsp;params)</code>
<div class="block">Constructor setting up data storage for a survey session.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#addInviteeAndDisplayPage(java.util.Map)">addInviteeAndDisplayPage</a></strong>(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;requestParameters)</code>
<div class="block">Adds a new invitee and then displays the page.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#addInviteeAndReturnUserId(java.util.Map)">addInviteeAndReturnUserId</a></strong>(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;requestParameters)</code>
<div class="block">Adds a new invitee and then returns the id.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#appendData(edu.ucla.wise.commons.Survey, java.lang.String)">appendData</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey,
          java.lang.String&nbsp;archiveDate)</code>
<div class="block">Append the data in the same named column(s) from archived data table to
 the newly created one.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#archiveProdSurvey(edu.ucla.wise.commons.Survey)">archiveProdSurvey</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Deletes survey references - those related data tables while survey is in
 production mode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#archiveTable(java.lang.String)">archiveTable</a></strong>(java.lang.String&nbsp;tableName)</code>
<div class="block">Archives old survey tables.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#archiveTable(edu.ucla.wise.commons.Survey)">archiveTable</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">archive the old data table -- called both for D and P mode if new survey
 uploaded or if P survey closed</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#clearSurveyData(edu.ucla.wise.commons.Survey)">clearSurveyData</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Clears data from data tables including the survey data table & subject
 set data tables.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#clearSurveyUseData(edu.ucla.wise.commons.Survey)">clearSurveyUseData</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Delete associated "use" data for the survey -- should only be enabled in
 Development mode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#createRepeatingSetTable(edu.ucla.wise.commons.RepeatingItemSet)">createRepeatingSetTable</a></strong>(<a href="../../../../edu/ucla/wise/commons/RepeatingItemSet.html" title="class in edu.ucla.wise.commons">RepeatingItemSet</a>&nbsp;iRepeatingSet)</code>
<div class="block">Creating tables for repeating item set questions in the survey.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#deleteSurvey(edu.ucla.wise.commons.Survey)">deleteSurvey</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Drop data tables including the survey data table & subject set data
 tables; update surveys table Remove a survey -- should only be called for
 Development mode surveys.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#displayAddInvitee()">displayAddInvitee</a></strong>()</code>
<div class="block">Returns the HTML format of the fields in invitees.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#displayAddInvitee(java.lang.String)">displayAddInvitee</a></strong>(java.lang.String&nbsp;surveyId)</code>
<div class="block">Returns the HTML format of the fields in invitees for a particular
 survey.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getCurrentSurveyIdString()">getCurrentSurveyIdString</a></strong>()</code>
<div class="block">Returns the ID of the current survey.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Hashtable&lt;java.lang.String,java.lang.Integer&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getDataForItem(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">getDataForItem</a></strong>(java.lang.String&nbsp;surveyId,
              java.lang.String&nbsp;pgName,
              java.lang.String&nbsp;itemName,
              java.lang.String&nbsp;whereclause)</code>
<div class="block">Gets information about a question from the survey data table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.sql.Connection</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getDBConnection()">getDBConnection</a></strong>()</code>
<div class="block">Establishes data base connection and returns a Connection object for
 other functions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.io.InputStream</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getFileFromDatabase(java.lang.String, java.lang.String)">getFileFromDatabase</a></strong>(java.lang.String&nbsp;fileName,
                   java.lang.String&nbsp;studySpaceName)</code>
<div class="block">Loads file from the data base.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.HashMap&lt;java.lang.String,java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getHistogramForItem(edu.ucla.wise.commons.Page, java.lang.String, float, float, java.lang.String)">getHistogramForItem</a></strong>(<a href="../../../../edu/ucla/wise/commons/Page.html" title="class in edu.ucla.wise.commons">Page</a>&nbsp;page,
                   java.lang.String&nbsp;itemName,
                   float&nbsp;scaleStart,
                   float&nbsp;binWidthFinal,
                   java.lang.String&nbsp;whereclause)</code>
<div class="block">Generates a histogram of a particular question for all the response set
 for that Item.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.HashMap&lt;java.lang.String,java.lang.Float&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getMinMaxForItem(edu.ucla.wise.commons.Page, java.lang.String, java.lang.String)">getMinMaxForItem</a></strong>(<a href="../../../../edu/ucla/wise/commons/Page.html" title="class in edu.ucla.wise.commons">Page</a>&nbsp;page,
                java.lang.String&nbsp;itemName,
                java.lang.String&nbsp;whereclause)</code>
<div class="block">Returns the maximum and minimum for an item in the survey data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a></code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getSurvey(java.lang.String)">getSurvey</a></strong>(java.lang.String&nbsp;sid)</code>
<div class="block">Searches by the survey ID and returns a specific survey.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.io.InputStream</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#getXmlFileFromDatabase(java.lang.String, java.lang.String)">getXmlFileFromDatabase</a></strong>(java.lang.String&nbsp;fileName,
                      java.lang.String&nbsp;studySpaceName)</code>
<div class="block">Loads file from the data base.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#lastSurveyHealthUpdateTime(java.lang.String)">lastSurveyHealthUpdateTime</a></strong>(java.lang.String&nbsp;studyName)</code>
<div class="block">Returns the time when the status of the survey system has been updated in
 the database in milli seconds.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../edu/ucla/wise/commons/User.html" title="class in edu.ucla.wise.commons">User</a></code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#makeUserFromMsgID(java.lang.String)">makeUserFromMsgID</a></strong>(java.lang.String&nbsp;msgId)</code>
<div class="block">Creates a User object form the message ID that is obtained from the URL
 whenever a user tries to use WISE system.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#readSurveys()">readSurveys</a></strong>()</code>
<div class="block">Gets list of current survey xml files and request loading of each by
 studySpace</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#recordMessageUse(java.lang.String, java.lang.String, java.lang.String)">recordMessageUse</a></strong>(java.lang.String&nbsp;messageId,
                java.lang.String&nbsp;inviteeId,
                java.lang.String&nbsp;surveyID)</code>
<div class="block">Enters new record in survey_message_use table for the new URL.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#recordSurveyState(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">recordSurveyState</a></strong>(java.lang.String&nbsp;state,
                 java.lang.String&nbsp;inviteeId,
                 java.lang.String&nbsp;surveyID,
                 java.lang.String&nbsp;messageSeqId)</code>
<div class="block">Record an entry into table survey_user_state.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#replacePattern(java.lang.String, java.lang.String)">replacePattern</a></strong>(java.lang.String&nbsp;msg,
              java.lang.String&nbsp;inviteeId)</code>
<div class="block">This Method is used to replace the patterns in the email body.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#sendReminders()">sendReminders</a></strong>()</code>
<div class="block">ITERATE over all study spaces and send email invitations to any subject
 due for a reminder or pending for initial invite.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#SetupDB(edu.ucla.wise.initializer.WiseProperties)">SetupDB</a></strong>(<a href="../../../../edu/ucla/wise/initializer/WiseProperties.html" title="class in edu.ucla.wise.initializer">WiseProperties</a>&nbsp;properties)</code>
<div class="block">Sets the Database driver from the properties file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#setupSurvey(edu.ucla.wise.commons.Survey)">setupSurvey</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Creates the tables for storing the responses for the survey questions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#syncInviteeTable(edu.ucla.wise.commons.InviteeMetadata)">syncInviteeTable</a></strong>(<a href="../../../../edu/ucla/wise/commons/InviteeMetadata.html" title="class in edu.ucla.wise.commons">InviteeMetadata</a>&nbsp;inviteeMetadata)</code>
<div class="block">If a new survey is uploaded and there is changes the invitee_fields, this
 function will make sure that database and survey fields remain in sync.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#updateArchiveDate(edu.ucla.wise.commons.Survey)">updateArchiveDate</a></strong>(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</code>
<div class="block">Updates the value of archive date in table of surveys</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#updateMessageUse(java.lang.String, java.lang.String, java.lang.String)">updateMessageUse</a></strong>(java.lang.String&nbsp;messageId,
                java.lang.String&nbsp;inviteeId,
                java.lang.String&nbsp;surveyID)</code>
<div class="block">Updates the message id in survey_message_use table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../edu/ucla/wise/commons/DataBank.html#updateSurveyHealthStatus(java.lang.String)">updateSurveyHealthStatus</a></strong>(java.lang.String&nbsp;surveyName)</code>
<div class="block">Updates the status of the survey system into data base.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="mysqlServer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mysqlServer</h4>
<pre>public static&nbsp;java.lang.String mysqlServer</pre>
</li>
</ul>
<a name="dbDriver">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dbDriver</h4>
<pre>public static final&nbsp;java.lang.String dbDriver</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.dbDriver">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="MainTableExtension">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MainTableExtension</h4>
<pre>public static final&nbsp;java.lang.String MainTableExtension</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.MainTableExtension">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="intValueTypeFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>intValueTypeFlag</h4>
<pre>public static final&nbsp;char intValueTypeFlag</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.intValueTypeFlag">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="textValueTypeFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>textValueTypeFlag</h4>
<pre>public static final&nbsp;char textValueTypeFlag</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.textValueTypeFlag">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="decimalValueTypeFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decimalValueTypeFlag</h4>
<pre>public static final&nbsp;char decimalValueTypeFlag</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.decimalValueTypeFlag">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="intFieldDDL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>intFieldDDL</h4>
<pre>public static final&nbsp;java.lang.String intFieldDDL</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.intFieldDDL">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="textFieldDDL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>textFieldDDL</h4>
<pre>public static final&nbsp;java.lang.String textFieldDDL</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.textFieldDDL">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="decimalFieldDDL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decimalFieldDDL</h4>
<pre>public static final&nbsp;java.lang.String decimalFieldDDL</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../constant-values.html#edu.ucla.wise.commons.DataBank.decimalFieldDDL">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="dbdata">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dbdata</h4>
<pre>public&nbsp;java.lang.String dbdata</pre>
</li>
</ul>
<a name="dbuser">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dbuser</h4>
<pre>public&nbsp;java.lang.String dbuser</pre>
</li>
</ul>
<a name="dbpwd">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dbpwd</h4>
<pre>public&nbsp;java.lang.String dbpwd</pre>
</li>
</ul>
<a name="emailEncryptionKey">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>emailEncryptionKey</h4>
<pre>public&nbsp;java.lang.String emailEncryptionKey</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DataBank(edu.ucla.wise.commons.StudySpace, edu.ucla.wise.studyspace.parameters.StudySpaceParameters)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DataBank</h4>
<pre>public&nbsp;DataBank(<a href="../../../../edu/ucla/wise/commons/StudySpace.html" title="class in edu.ucla.wise.commons">StudySpace</a>&nbsp;ss,
        edu.ucla.wise.studyspace.parameters.StudySpaceParameters&nbsp;params)</pre>
<div class="block">Constructor setting up data storage for a survey session. All the
 parameters are now obtained from database</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ss</code> - Study space to which the data bank class is linked to.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="SetupDB(edu.ucla.wise.initializer.WiseProperties)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>SetupDB</h4>
<pre>public static&nbsp;void&nbsp;SetupDB(<a href="../../../../edu/ucla/wise/initializer/WiseProperties.html" title="class in edu.ucla.wise.initializer">WiseProperties</a>&nbsp;properties)</pre>
<div class="block">Sets the Database driver from the properties file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>props</code> - Resource bundle object from which the details of the data base
            driver are obtained.</dd></dl>
</li>
</ul>
<a name="readSurveys()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readSurveys</h4>
<pre>public&nbsp;void&nbsp;readSurveys()</pre>
<div class="block">Gets list of current survey xml files and request loading of each by
 studySpace</div>
</li>
</ul>
<a name="makeUserFromMsgID(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeUserFromMsgID</h4>
<pre>public&nbsp;<a href="../../../../edu/ucla/wise/commons/User.html" title="class in edu.ucla.wise.commons">User</a>&nbsp;makeUserFromMsgID(java.lang.String&nbsp;msgId)</pre>
<div class="block">Creates a User object form the message ID that is obtained from the URL
 whenever a user tries to use WISE system.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>msgId</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="getDBConnection()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDBConnection</h4>
<pre>public&nbsp;java.sql.Connection&nbsp;getDBConnection()
                                    throws java.sql.SQLException</pre>
<div class="block">Establishes data base connection and returns a Connection object for
 other functions.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>Connection Database connection object.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="getSurvey(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSurvey</h4>
<pre>public&nbsp;<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;getSurvey(java.lang.String&nbsp;sid)</pre>
<div class="block">Searches by the survey ID and returns a specific survey.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>surveyId</code> - Survey Id which has to be returned.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Survey Survey object associated with the surveyId.</dd></dl>
</li>
</ul>
<a name="setupSurvey(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setupSurvey</h4>
<pre>public&nbsp;void&nbsp;setupSurvey(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)
                 throws java.sql.SQLException</pre>
<div class="block">Creates the tables for storing the responses for the survey questions.
 This function is called while loading the survey.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey for which tables have to be created.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="createRepeatingSetTable(edu.ucla.wise.commons.RepeatingItemSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createRepeatingSetTable</h4>
<pre>public&nbsp;void&nbsp;createRepeatingSetTable(<a href="../../../../edu/ucla/wise/commons/RepeatingItemSet.html" title="class in edu.ucla.wise.commons">RepeatingItemSet</a>&nbsp;iRepeatingSet)</pre>
<div class="block">Creating tables for repeating item set questions in the survey.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>iRepeatingSet</code> - RepeatingItemSet for which table has to be created.</dd></dl>
</li>
</ul>
<a name="updateArchiveDate(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateArchiveDate</h4>
<pre>public&nbsp;void&nbsp;updateArchiveDate(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">Updates the value of archive date in table of surveys</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey for which tables have to be updated.</dd></dl>
</li>
</ul>
<a name="archiveTable(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>archiveTable</h4>
<pre>public&nbsp;java.lang.String&nbsp;archiveTable(java.lang.String&nbsp;tableName)</pre>
<div class="block">Archives old survey tables.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>tableName</code> - Table that has to be archived.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String The date when the table is archived.</dd></dl>
</li>
</ul>
<a name="archiveTable(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>archiveTable</h4>
<pre>public&nbsp;java.lang.String&nbsp;archiveTable(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">archive the old data table -- called both for D and P mode if new survey
 uploaded or if P survey closed</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey whose tables are to be archived.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String The date when the table are archived.</dd></dl>
</li>
</ul>
<a name="appendData(edu.ucla.wise.commons.Survey, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>appendData</h4>
<pre>public&nbsp;void&nbsp;appendData(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey,
              java.lang.String&nbsp;archiveDate)
                throws java.sql.SQLException</pre>
<div class="block">Append the data in the same named column(s) from archived data table to
 the newly created one.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey whose tables are to be appended and archived.</dd><dd><code>archiveDate</code> - Archive data of the old table.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="deleteSurvey(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteSurvey</h4>
<pre>public&nbsp;java.lang.String&nbsp;deleteSurvey(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">Drop data tables including the survey data table & subject set data
 tables; update surveys table Remove a survey -- should only be called for
 Development mode surveys.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey which has to be removed.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML string of all the dropped tables.</dd></dl>
</li>
</ul>
<a name="archiveProdSurvey(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>archiveProdSurvey</h4>
<pre>public&nbsp;java.lang.String&nbsp;archiveProdSurvey(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">Deletes survey references - those related data tables while survey is in
 production mode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey whose table references are to be removed.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML output saying the survey has been closed.</dd></dl>
</li>
</ul>
<a name="clearSurveyData(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearSurveyData</h4>
<pre>public&nbsp;java.lang.String&nbsp;clearSurveyData(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">Clears data from data tables including the survey data table & subject
 set data tables.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey whose table references are to be cleared.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML response of the status of clearing the table data.</dd></dl>
</li>
</ul>
<a name="clearSurveyUseData(edu.ucla.wise.commons.Survey)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clearSurveyUseData</h4>
<pre>public&nbsp;java.lang.String&nbsp;clearSurveyUseData(<a href="../../../../edu/ucla/wise/commons/Survey.html" title="class in edu.ucla.wise.commons">Survey</a>&nbsp;survey)</pre>
<div class="block">Delete associated "use" data for the survey -- should only be enabled in
 Development mode.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>survey</code> - Survey whose all the associated table data is to be cleared.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML response of the status of clearing the table data.</dd></dl>
</li>
</ul>
<a name="sendReminders()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendReminders</h4>
<pre>public&nbsp;java.lang.String&nbsp;sendReminders()</pre>
<div class="block">ITERATE over all study spaces and send email invitations to any subject
 due for a reminder or pending for initial invite.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>String Outputs when the process of sending emails end.</dd></dl>
</li>
</ul>
<a name="getDataForItem(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDataForItem</h4>
<pre>public&nbsp;java.util.Hashtable&lt;java.lang.String,java.lang.Integer&gt;&nbsp;getDataForItem(java.lang.String&nbsp;surveyId,
                                                                     java.lang.String&nbsp;pgName,
                                                                     java.lang.String&nbsp;itemName,
                                                                     java.lang.String&nbsp;whereclause)</pre>
<div class="block">Gets information about a question from the survey data table.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>surveyId</code> - Survey Id for which results are to be obtained.</dd><dd><code>pgName</code> - Page name which contains this question.</dd><dd><code>itemName</code> - Question name that needs results.</dd><dd><code>whereclause</code> - Selection of the invitees.</dd>
<dt><span class="strong">Returns:</span></dt><dd>Hashtable Results of the item.</dd></dl>
</li>
</ul>
<a name="getMinMaxForItem(edu.ucla.wise.commons.Page, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMinMaxForItem</h4>
<pre>public&nbsp;java.util.HashMap&lt;java.lang.String,java.lang.Float&gt;&nbsp;getMinMaxForItem(<a href="../../../../edu/ucla/wise/commons/Page.html" title="class in edu.ucla.wise.commons">Page</a>&nbsp;page,
                                                                   java.lang.String&nbsp;itemName,
                                                                   java.lang.String&nbsp;whereclause)</pre>
<div class="block">Returns the maximum and minimum for an item in the survey data.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>page</code> - Page name which contains this item.</dd><dd><code>itemName</code> - Question whose max and min values are asked for.</dd><dd><code>whereclause</code> - The invitees from whom these values are to be selected.</dd>
<dt><span class="strong">Returns:</span></dt><dd>HashMap Result</dd></dl>
</li>
</ul>
<a name="getHistogramForItem(edu.ucla.wise.commons.Page, java.lang.String, float, float, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHistogramForItem</h4>
<pre>public&nbsp;java.util.HashMap&lt;java.lang.String,java.lang.String&gt;&nbsp;getHistogramForItem(<a href="../../../../edu/ucla/wise/commons/Page.html" title="class in edu.ucla.wise.commons">Page</a>&nbsp;page,
                                                                       java.lang.String&nbsp;itemName,
                                                                       float&nbsp;scaleStart,
                                                                       float&nbsp;binWidthFinal,
                                                                       java.lang.String&nbsp;whereclause)</pre>
<div class="block">Generates a histogram of a particular question for all the response set
 for that Item.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>page</code> - Page name which contains this item.</dd><dd><code>itemName</code> - Question whose max and min values are asked for.</dd><dd><code>scaleStart</code> - Start scale of histogram.</dd><dd><code>binWidthFinal</code> - Width of the histogram.</dd><dd><code>whereclause</code> - The invitees from whom these values are to be selected.</dd>
<dt><span class="strong">Returns:</span></dt><dd>HashMap Result of the histogram</dd></dl>
</li>
</ul>
<a name="updateSurveyHealthStatus(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateSurveyHealthStatus</h4>
<pre>public&nbsp;void&nbsp;updateSurveyHealthStatus(java.lang.String&nbsp;surveyName)</pre>
<div class="block">Updates the status of the survey system into data base.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>surveyName</code> - Name of the survey whose status is updated.</dd></dl>
</li>
</ul>
<a name="lastSurveyHealthUpdateTime(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastSurveyHealthUpdateTime</h4>
<pre>public&nbsp;long&nbsp;lastSurveyHealthUpdateTime(java.lang.String&nbsp;studyName)</pre>
<div class="block">Returns the time when the status of the survey system has been updated in
 the database in milli seconds.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>studyName</code> - Name of the whose value is needed.</dd>
<dt><span class="strong">Returns:</span></dt><dd>long Time in milli seconds.</dd></dl>
</li>
</ul>
<a name="displayAddInvitee()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>displayAddInvitee</h4>
<pre>public&nbsp;java.lang.String&nbsp;displayAddInvitee()</pre>
<div class="block">Returns the HTML format of the fields in invitees. This is used by admin
 page to add new invitee information</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>String HTML format of the invitee fields.</dd></dl>
</li>
</ul>
<a name="displayAddInvitee(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>displayAddInvitee</h4>
<pre>public&nbsp;java.lang.String&nbsp;displayAddInvitee(java.lang.String&nbsp;surveyId)</pre>
<div class="block">Returns the HTML format of the fields in invitees for a particular
 survey. This is used by admin page to add new invitee information</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>surveyId</code> - Name of the survey whose invitee fields are to be displayed.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML format of the invitee fields.</dd></dl>
</li>
</ul>
<a name="addInviteeAndDisplayPage(java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInviteeAndDisplayPage</h4>
<pre>public&nbsp;java.lang.String&nbsp;addInviteeAndDisplayPage(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;requestParameters)</pre>
<div class="block">Adds a new invitee and then displays the page.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>requestParameters</code> - parameters need for adding a new invitee into the tables.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String HTML format of the further Page.</dd></dl>
</li>
</ul>
<a name="addInviteeAndReturnUserId(java.util.Map)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addInviteeAndReturnUserId</h4>
<pre>public&nbsp;int&nbsp;addInviteeAndReturnUserId(java.util.Map&lt;java.lang.String,java.lang.String&gt;&nbsp;requestParameters)</pre>
<div class="block">Adds a new invitee and then returns the id.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>requestParameters</code> - parameters need for adding a new invitee into the tables.</dd>
<dt><span class="strong">Returns:</span></dt><dd>int Id of the new invitee added.</dd></dl>
</li>
</ul>
<a name="getCurrentSurveyIdString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentSurveyIdString</h4>
<pre>public&nbsp;java.lang.String&nbsp;getCurrentSurveyIdString()</pre>
<div class="block">Returns the ID of the current survey.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>String Name of the current survey.</dd></dl>
</li>
</ul>
<a name="syncInviteeTable(edu.ucla.wise.commons.InviteeMetadata)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>syncInviteeTable</h4>
<pre>public&nbsp;void&nbsp;syncInviteeTable(<a href="../../../../edu/ucla/wise/commons/InviteeMetadata.html" title="class in edu.ucla.wise.commons">InviteeMetadata</a>&nbsp;inviteeMetadata)</pre>
<div class="block">If a new survey is uploaded and there is changes the invitee_fields, this
 function will make sure that database and survey fields remain in sync.
 This function ensures that it does not touches the default mandatory
 arguments in the invitee table, even if they are tampered in the survey
 XML.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>inviteeMetadata</code> - Object which contains the metadata of the invitees populated
            from the survey table.</dd></dl>
</li>
</ul>
<a name="getFileFromDatabase(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileFromDatabase</h4>
<pre>public&nbsp;java.io.InputStream&nbsp;getFileFromDatabase(java.lang.String&nbsp;fileName,
                                      java.lang.String&nbsp;studySpaceName)</pre>
<div class="block">Loads file from the data base.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileName</code> - File name that is to be loaded from the database.</dd><dd><code>studySpaceName</code> - StudySpace from the file has to be loaded.</dd>
<dt><span class="strong">Returns:</span></dt><dd>InputStream The file read form the data base is sent as the
         stream to the caller functions.</dd></dl>
</li>
</ul>
<a name="getXmlFileFromDatabase(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getXmlFileFromDatabase</h4>
<pre>public&nbsp;java.io.InputStream&nbsp;getXmlFileFromDatabase(java.lang.String&nbsp;fileName,
                                         java.lang.String&nbsp;studySpaceName)</pre>
<div class="block">Loads file from the data base. These are the survey xml files.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fileName</code> - File name that is to be loaded from the database.</dd><dd><code>studySpaceName</code> - StudySpace from the file has to be loaded.</dd>
<dt><span class="strong">Returns:</span></dt><dd>InputStream The file read form the data base is sent as the
         stream to the caller functions.</dd></dl>
</li>
</ul>
<a name="replacePattern(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>replacePattern</h4>
<pre>public&nbsp;java.lang.String&nbsp;replacePattern(java.lang.String&nbsp;msg,
                              java.lang.String&nbsp;inviteeId)</pre>
<div class="block">This Method is used to replace the patterns in the email body.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>msg</code> - Message whose content has to be matched and replaced.</dd><dd><code>inviteeId</code> - Invitee for whom the message is sent as email.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String The modified Message.</dd></dl>
</li>
</ul>
<a name="recordMessageUse(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordMessageUse</h4>
<pre>public&nbsp;java.lang.String&nbsp;recordMessageUse(java.lang.String&nbsp;messageId,
                                java.lang.String&nbsp;inviteeId,
                                java.lang.String&nbsp;surveyID)</pre>
<div class="block">Enters new record in survey_message_use table for the new URL.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>messageId</code> - Message id of the new record</dd><dd><code>inviteeId</code> - Invitee Id for whom the mail is sent.</dd><dd><code>surveyID</code> - Survey name for which this user is linked to.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String New randomly generated number.</dd></dl>
</li>
</ul>
<a name="updateMessageUse(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateMessageUse</h4>
<pre>public&nbsp;java.lang.String&nbsp;updateMessageUse(java.lang.String&nbsp;messageId,
                                java.lang.String&nbsp;inviteeId,
                                java.lang.String&nbsp;surveyID)</pre>
<div class="block">Updates the message id in survey_message_use table.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>messageId</code> - Message id of the new record</dd><dd><code>inviteeId</code> - Invitee Id for whom the mail is sent.</dd><dd><code>surveyID</code> - Survey name for which this user is linked to.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String Returns success in case of correct update.</dd></dl>
</li>
</ul>
<a name="recordSurveyState(java.lang.String, java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>recordSurveyState</h4>
<pre>public&nbsp;java.lang.String&nbsp;recordSurveyState(java.lang.String&nbsp;state,
                                 java.lang.String&nbsp;inviteeId,
                                 java.lang.String&nbsp;surveyID,
                                 java.lang.String&nbsp;messageSeqId)</pre>
<div class="block">Record an entry into table survey_user_state.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>state</code> - State to be record.</dd><dd><code>inviteeId</code> - Invitee id .</dd><dd><code>surveyID</code> - Survey name.</dd><dd><code>messageSeqId</code> - Name of the message sequence.</dd>
<dt><span class="strong">Returns:</span></dt><dd>String Sucess is returned if true.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DataBank.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../edu/ucla/wise/commons/ConsentForm.html" title="class in edu.ucla.wise.commons"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../edu/ucla/wise/commons/Directive.html" title="class in edu.ucla.wise.commons"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/ucla/wise/commons/DataBank.html" target="_top">Frames</a></li>
<li><a href="DataBank.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
